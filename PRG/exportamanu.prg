SET DATE BRITISH 
SET CENTURY ON
SELECT 0
USE C:\SUERUT\EMPRE1\SUE3 SHARED
SELECT 0
USE f:\sueldos\nwga\export\marzo SHARED ALIAS INFOFIN



vvfecha = CTOD("31-03-2012")
SET DEVICE TO SCREEN
DELETE FILE "C:\SUERUT\EMPRE1\DGI.TXT"
SET DEVICE TO FILE "C:\SUERUT\EMPRE1\DGI.TXT"
SET FILTER TO RET <> 0
WCOMPRO = " "
lin = 0
vvfecha = CTOD("01/03/2012")
SELECT INFOFIN
GO TOP
DO WHILE .NOT. EOF()
   IF RET > 0
      @LIN,0  SAY "07" 
   ELSE
      @LIN,0  SAY "08"  
      LOCAL importe as Number
      importe = 0
      importe = ABS(RET)
      REPLACE RET WITH IMPORTE
    ENDIF
   
   @LIN,2  SAY vvfecha
  IF LEGAJO < 10
      WCOMPRO =  IIF (LEGAJO< 100,LTRIM(STR(MONTH(vvfecha),2))+"01"+ LTRIM(STR(LEGAJO,4)),LTRIM(STR(MONTH(vvfecha),2)) + LTRIM(STR(LEGAJO,4)))
  ELSE
      WCOMPRO =  IIF (LEGAJO< 100,LTRIM(STR(MONTH(vvfecha),2))+"1"+ LTRIM(STR(LEGAJO,4)),LTRIM(STR(MONTH(vvfecha),2)) + LTRIM(STR(LEGAJO,4)))
  ENDIF
   
   *+ STR(LEGAJO,4)
   @LIN,12 SAY WCOMPRO
   *            123456798-123456    
   @LIN,28  SAY "0000000000000.00"
   @LIN,44  SAY "217"
   @LIN,47  SAY "160"
   @LIN,50  SAY "1"
   *BASE DE CALCULO
   *             123456789-1234    
   *@LIN,51  SAY "00000000000.00"
   @LIN,51  SAY RET PICTURE "99999.99"
   @LIN,65  SAY vvfecha picture "!!/!!/!!!!"
   @LIN,75  SAY "01"
   @LIN,77  SAY "0"
   @LIN,78  SAY RET PICTURE "99999.99"
   @LIN,92  SAY "000000"
   @LIN,98  SAY " "
   @LIN,108 SAY "86"
   @LIN,110 SAY CUIL
   @LIN,130 SAY "0000000000000"
   @LIN,144 SAY " "
   @LIN,174 SAY "0"
   @LIN,175 SAY " "
   @LIN,186 SAY " "  
    SKIP
    LIN = LIN + 1
ENDDO

SET DEVICE TO SCREEN
SET SAFETY OFF
*FCLOSE("C:\SUERUT\EMPRE1\DGI.TXT")

MODIFY FILE C:\SUERUT\EMPRE1\DGI.TXT
